from omni.isaac.gym.vec_env import VecEnvBase
import torch

env = VecEnvBase(headless=True)

from robotpuck_task import RobotPuckTask

task = RobotPuckTask(name="Cartpole")
env.set_task(task, backend="torch") 

from stable_baselines3 import DDPG
import optuna
from stable_baselines3.common.noise import NormalActionNoise
model = DDPG(
    "MlpPolicy", 
    env, 
    action_noise=action_noise, 
    batch_size=256, 
    buffer_size=1000000, 
    learning_rate=1e-3, 
    tau=0.005,
    gamma=0.99,
    verbose=1
)

model.learn(total_timesteps=200000)
model.save("ddpg_policy")